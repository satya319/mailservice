# DNS Configuration Guide for jamjhadi.shop

This guide will help you configure DNS records for your domain `jamjhadi.shop` to enable email functionality with your CustomMail server.

## Prerequisites

1. **Server IP Address**: You need a public IP address where your CustomMail server will run
2. **Domain Access**: Administrative access to your domain's DNS settings
3. **Server Setup**: Your server should be accessible on ports 25, 587, and 993/995 (for IMAP/POP3 if needed)

## Required DNS Records

### 1. A Record for Mail Server
```
Type: A
Name: mail
Value: YOUR_SERVER_IP
TTL: 3600 (1 hour)
```

### 2. MX Record for Email Routing
```
Type: MX
Name: @ (or jamjhadi.shop)
Value: mail.jamjhadi.shop
Priority: 10
TTL: 3600 (1 hour)
```

### 3. SPF Record for Email Authentication
```
Type: TXT
Name: @ (or jamjhadi.shop)
Value: v=spf1 mx a ip4:YOUR_SERVER_IP ~all
TTL: 3600 (1 hour)
```

### 4. DMARC Record for Email Policy
```
Type: TXT
Name: _dmarc
Value: v=DMARC1; p=quarantine; rua=mailto:dmarc@jamjhadi.shop
TTL: 3600 (1 hour)
```

### 5. DKIM Record (Generate after server setup)
```
Type: TXT
Name: default._domainkey
Value: [Will be generated by your server]
TTL: 3600 (1 hour)
```

## Step-by-Step DNS Configuration

### For Most DNS Providers (Cloudflare, Namecheap, GoDaddy, etc.):

1. **Log into your DNS provider's control panel**

2. **Add A Record:**
   - Go to DNS management
   - Click "Add Record"
   - Type: A
   - Name: mail
   - Value: [Your server's public IP]
   - Save

3. **Add MX Record:**
   - Click "Add Record"
   - Type: MX
   - Name: @ (or leave blank for root domain)
   - Value: mail.jamjhadi.shop
   - Priority: 10
   - Save

4. **Add SPF Record:**
   - Click "Add Record"
   - Type: TXT
   - Name: @ (or leave blank for root domain)
   - Value: `v=spf1 mx a ip4:YOUR_SERVER_IP ~all`
   - Save

5. **Add DMARC Record:**
   - Click "Add Record"
   - Type: TXT
   - Name: _dmarc
   - Value: `v=DMARC1; p=quarantine; rua=mailto:dmarc@jamjhadi.shop`
   - Save

## Server Configuration Requirements

### 1. Firewall Rules
Ensure these ports are open on your server:
```bash
# SMTP (receiving emails)
Port 25 - Open to world

# SMTP Submission (sending emails)
Port 587 - Open to world

# Web interface
Port 3001 - Open to world (or restrict to your IP)

# API
Port 3002 - Open to world (or restrict to your IP)
```

### 2. Reverse DNS (PTR Record)
Contact your hosting provider to set up reverse DNS:
```
YOUR_SERVER_IP → mail.jamjhadi.shop
```

### 3. SSL/TLS Certificates (Recommended)
For production use, obtain SSL certificates:
```bash
# Using Let's Encrypt (example)
sudo certbot certonly --standalone -d mail.jamjhadi.shop
```

## Testing Your Configuration

### 1. Test DNS Records
```bash
# Test MX record
dig MX jamjhadi.shop

# Test A record
dig A mail.jamjhadi.shop

# Test SPF record
dig TXT jamjhadi.shop

# Test DMARC record
dig TXT _dmarc.jamjhadi.shop
```

### 2. Test Email Delivery
```bash
# Test sending email to Gmail
echo "Test email body" | mail -s "Test Subject" your-gmail@gmail.com

# Check if your server can receive emails
telnet mail.jamjhadi.shop 25
```

### 3. Online Tools
Use these online tools to verify your setup:
- MX Toolbox: https://mxtoolbox.com/
- Mail Tester: https://www.mail-tester.com/
- DMARC Analyzer: https://www.dmarcanalyzer.com/

## Common DNS Provider Instructions

### Cloudflare
1. Login to Cloudflare dashboard
2. Select your domain `jamjhadi.shop`
3. Go to DNS tab
4. Add records as specified above
5. Ensure proxy status is "DNS only" (gray cloud) for mail record

### Namecheap
1. Login to Namecheap account
2. Go to Domain List → Manage
3. Advanced DNS tab
4. Add records as specified above

### GoDaddy
1. Login to GoDaddy account
2. My Products → DNS
3. Add records as specified above

## Important Notes

1. **DNS Propagation**: Changes can take 24-48 hours to fully propagate
2. **TTL Values**: Lower TTL (like 300 seconds) during initial setup for faster changes
3. **Backup MX**: Consider adding a backup MX record with higher priority
4. **Security**: Always use strong passwords and enable 2FA on your DNS provider

## Troubleshooting

### Common Issues:
1. **Emails not received**: Check MX record and firewall
2. **Emails marked as spam**: Verify SPF, DKIM, and DMARC records
3. **Cannot send emails**: Check reverse DNS and port 25 access
4. **DNS not resolving**: Wait for propagation or check record syntax

### Getting Help:
- Check server logs: `tail -f /var/log/mail.log`
- Test with: `telnet mail.jamjhadi.shop 25`
- Verify DNS: `nslookup -type=MX jamjhadi.shop`

## Next Steps

After DNS configuration:
1. Update your server's IP in config.js
2. Generate DKIM keys
3. Test email sending and receiving
4. Set up SSL certificates
5. Configure email client settings

---

**Remember**: Replace `YOUR_SERVER_IP` with your actual server's public IP address in all configurations!